{% extends "layouts/base.html.twig" %}
{% import "components/forms.html.twig" as forms %}
{% import "components/ui.html.twig" as ui %}

{% block title %}Додати визначення KPI - Клініка{% endblock %}

{% block body %}
    <div class="ui segment">
        <h2 class="ui header">Додати нове визначення KPI</h2>
        <div class="ui divider"></div>

        <form class="ui form" method="POST" action="/kpi/definitions/new">
            {{ forms.input('name', 'Назва KPI', old.name ?? '', 'text', 'Наприклад, Кількість прийомів за місяць', errors.name ?? null, {'required': 'required'}) }}
            {{ forms.textarea('description', 'Опис KPI', old.description ?? '', 'Детальний опис KPI', errors.description ?? null) }}
            
            <div class="field {% if errors.kpi_type %}error{% endif %}">
                <label>Тип KPI</label>
                <select class="ui dropdown" name="kpi_type">
                    <option value="">Виберіть тип</option>
                    <option value="appointments_count" {% if old.kpi_type == 'appointments_count' %}selected{% endif %}>Кількість прийомів</option>
                    <option value="revenue_generated" {% if old.kpi_type == 'revenue_generated' %}selected{% endif %}>Згенерований дохід</option>
                    <option value="patient_satisfaction" {% if old.kpi_type == 'patient_satisfaction' %}selected{% endif %}>Задоволеність пацієнтів</option>
                </select>
                {% if errors.kpi_type %}<div class="ui red basic pointing label">{{ errors.kpi_type | first }}</div>{% endif %}
            </div>

            {{ forms.input('target_value', 'Цільове значення (необов\'язково)', old.target_value ?? '', 'number', '0.00', errors.target_value ?? null, {'step': '0.01'}) }}
            {{ forms.input('unit', 'Одиниця виміру (необов\'язково)', old.unit ?? '', 'text', 'Наприклад, шт., грн., %', errors.unit ?? null) }}

            <div class="field">
                <div class="ui checkbox">
                    <input type="checkbox" name="is_active" {% if old.is_active is defined and old.is_active %}checked{% else %}checked{% endif %} value="1">
                    <label>Активне визначення</label>
                </div>
            </div>

            {{ ui.button('Зберегти визначення', 'primary', 'large', 'save') }}
            <a href="/kpi/definitions" class="ui button">Скасувати</a>
        </form>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function() {
            $('.ui.dropdown').dropdown();
        });
    </script>
{% endblock %}
