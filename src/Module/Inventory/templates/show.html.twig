{% extends "layouts/base.html.twig" %}

{% block title %}Позиція складу #{{ item.id }} - Клініка{% endblock %}

{% block body %}
    <div class="ui segment">
        <h2 class="ui header">Деталі позиції складу #{{ item.id }}</h2>
        <div class="ui divider"></div>

        <table class="ui unstackable definition table">
            <tbody>
                <tr>
                    <td>ID</td>
                    <td>{{ item.id }}</td>
                </tr>
                <tr>
                    <td>Назва</td>
                    <td>{{ item.name }}</td>
                </tr>
                <tr>
                    <td>Опис</td>
                    <td>{{ item.description|nl2br }}</td>
                </tr>
                <tr>
                    <td>INN</td>
                    <td>{{ item.inn }}</td>
                </tr>
                <tr>
                    <td>Номер партії</td>
                    <td>{{ item.batch_number }}</td>
                </tr>
                <tr>
                    <td>Термін придатності</td>
                    <td>{{ item.expiry_date }}</td>
                </tr>
                <tr>
                    <td>Постачальник</td>
                    <td>{{ item.supplier }}</td>
                </tr>
                <tr>
                    <td>Вартість (за одиницю)</td>
                    <td>{{ item.cost }}</td>
                </tr>
                <tr>
                    <td>Кількість</td>
                    <td>{{ item.quantity }}</td>
                </tr>
                <tr>
                    <td>Мінімальний рівень запасу</td>
                    <td>{{ item.min_stock_level }}</td>
                </tr>
                <tr>
                    <td>Максимальний рівень запасу</td>
                    <td>{{ item.max_stock_level }}</td>
                </tr>
                <tr>
                    <td>Місце зберігання</td>
                    <td>{{ item.location }}</td>
                </tr>
                <tr>
                    <td>Створено</td>
                    <td>{{ item.created_at|date('Y-m-d H:i') }}</td>
                </tr>
                <tr>
                    <td>Оновлено</td>
                    <td>{{ item.updated_at|date('Y-m-d H:i') }}</td>
                </tr>
            </tbody>
        </table>

        <div class="ui divider"></div>

        <a href="/inventory/edit?id={{ item.id }}" class="ui primary button">Редагувати</a>
        <a href="/inventory" class="ui button">Повернутися до списку</a>
    </div>

    <div class="ui segment">
        <h3 class="ui header">Історія рухів</h3>
        {% if movementHistory is empty %}
            <p>Немає записів історії рухів для цієї позиції.</p>
        {% else %}
            <table class="ui celled unstackable table">
                <thead>
                    <tr>
                        <th>Тип руху</th>
                        <th>Зміна кількості</th>
                        <th>Нова кількість</th>
                        <th>Причина</th>
                        <th>Користувач</th>
                        <th>Дата</th>
                    </tr>
                </thead>
                <tbody>
                    {% for movement in movementHistory %}
                        <tr>
                            <td>{{ movement.movement_type }}</td>
                            <td>{{ movement.quantity_change }}</td>
                            <td>{{ movement.new_quantity }}</td>
                            <td>{{ movement.reason ?: 'Не вказано' }}</td>
                            <td>{{ movement.user_name ?: 'Система' }}</td>
                            <td>{{ movement.created_at|date('Y-m-d H:i') }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
{% endblock %}
